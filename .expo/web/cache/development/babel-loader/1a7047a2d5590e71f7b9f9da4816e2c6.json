{"ast":null,"code":"import compareVersions from 'compare-versions';\nimport { CodedError } from './errors/CodedError';\nconst postedWarnings = {};\n/**\n * Used for deprecating values and throwing an error if a given version of Expo has passed.\n */\n\nexport default function deprecate(library, deprecatedAPI, options = {}) {\n  const {\n    currentVersion,\n    versionToRemove,\n    replacement\n  } = options;\n  const code = codeFromLibrary(library);\n  const key = `${code}:${deprecatedAPI}:${replacement}`;\n\n  if (!postedWarnings[key]) {\n    postedWarnings[key] = true;\n  }\n\n  if (!currentVersion || !versionToRemove || compareVersions(currentVersion, versionToRemove) >= 0) {\n    let message = `\\`${deprecatedAPI}\\` has been removed`;\n\n    if (versionToRemove) {\n      message = `${message} as of version \"${versionToRemove}\"`;\n    }\n\n    if (replacement && replacement.length) {\n      message = `${message} please migrate to: \\`${replacement}\\``;\n    }\n\n    throw new CodedError(`ERR_DEPRECATED_API`, prependLibrary(library, message));\n  }\n\n  let message = `\\`${deprecatedAPI}\\` has been deprecated`;\n\n  if (replacement && replacement.length) {\n    message = `${message} in favor of \\`${replacement}\\``;\n  }\n\n  if (versionToRemove && versionToRemove.length) {\n    message = `${message} and will be removed in version \"${versionToRemove}\"`;\n  }\n\n  console.warn(prependLibrary(library, message));\n}\n\nfunction prependLibrary(library, message) {\n  return `${library}: ${message}`;\n}\n/**\n * Transform format:\n * Expo.AR -> EXPO_AR\n * expo-ar -> EXPO_AR\n */\n\n\nfunction codeFromLibrary(library) {\n  const code = library.replace(/[-.]/g, '_').toUpperCase();\n  return code;\n}","map":{"version":3,"sources":["../src/deprecate.ts"],"names":[],"mappings":"AAAA,OAAO,eAAP,MAA4B,kBAA5B;AAEA,SAAS,UAAT,QAA2B,qBAA3B;AAEA,MAAM,cAAc,GAA+B,EAAnD;AAEA;;AAEG;;AACH,eAAc,SAAU,SAAV,CACZ,OADY,EAEZ,aAFY,EAGZ,OAAA,GAII,EAPQ,EAON;EAEN,MAAM;IAAE,cAAF;IAAkB,eAAlB;IAAmC;EAAnC,IAAmD,OAAzD;EACA,MAAM,IAAI,GAAG,eAAe,CAAC,OAAD,CAA5B;EACA,MAAM,GAAG,GAAG,GAAG,IAAI,IAAI,aAAa,IAAI,WAAW,EAAnD;;EACA,IAAI,CAAC,cAAc,CAAC,GAAD,CAAnB,EAA0B;IACxB,cAAc,CAAC,GAAD,CAAd,GAAsB,IAAtB;EACD;;EAED,IACE,CAAC,cAAD,IACA,CAAC,eADD,IAEA,eAAe,CAAC,cAAD,EAAiB,eAAjB,CAAf,IAAoD,CAHtD,EAIE;IACA,IAAI,OAAO,GAAG,KAAK,aAAa,qBAAhC;;IACA,IAAI,eAAJ,EAAqB;MACnB,OAAO,GAAG,GAAG,OAAO,mBAAmB,eAAe,GAAtD;IACD;;IACD,IAAI,WAAW,IAAI,WAAW,CAAC,MAA/B,EAAuC;MACrC,OAAO,GAAG,GAAG,OAAO,yBAAyB,WAAW,IAAxD;IACD;;IAED,MAAM,IAAI,UAAJ,CAAe,oBAAf,EAAqC,cAAc,CAAC,OAAD,EAAU,OAAV,CAAnD,CAAN;EACD;;EAED,IAAI,OAAO,GAAG,KAAK,aAAa,wBAAhC;;EACA,IAAI,WAAW,IAAI,WAAW,CAAC,MAA/B,EAAuC;IACrC,OAAO,GAAG,GAAG,OAAO,kBAAkB,WAAW,IAAjD;EACD;;EACD,IAAI,eAAe,IAAI,eAAe,CAAC,MAAvC,EAA+C;IAC7C,OAAO,GAAG,GAAG,OAAO,oCAAoC,eAAe,GAAvE;EACD;;EACD,OAAO,CAAC,IAAR,CAAa,cAAc,CAAC,OAAD,EAAU,OAAV,CAA3B;AACD;;AAED,SAAS,cAAT,CAAwB,OAAxB,EAAyC,OAAzC,EAAwD;EACtD,OAAO,GAAG,OAAO,KAAK,OAAO,EAA7B;AACD;AAED;;;;AAIG;;;AACH,SAAS,eAAT,CAAyB,OAAzB,EAAwC;EACtC,MAAM,IAAI,GAAG,OAAO,CAAC,OAAR,CAAgB,OAAhB,EAAyB,GAAzB,EAA8B,WAA9B,EAAb;EACA,OAAO,IAAP;AACD","sourcesContent":["import compareVersions from 'compare-versions';\n\nimport { CodedError } from './errors/CodedError';\n\nconst postedWarnings: { [key: string]: boolean } = {};\n\n/**\n * Used for deprecating values and throwing an error if a given version of Expo has passed.\n */\nexport default function deprecate(\n  library: string,\n  deprecatedAPI: string,\n  options: {\n    replacement?: string;\n    currentVersion?: string;\n    versionToRemove?: string;\n  } = {}\n): void {\n  const { currentVersion, versionToRemove, replacement } = options;\n  const code = codeFromLibrary(library);\n  const key = `${code}:${deprecatedAPI}:${replacement}`;\n  if (!postedWarnings[key]) {\n    postedWarnings[key] = true;\n  }\n\n  if (\n    !currentVersion ||\n    !versionToRemove ||\n    compareVersions(currentVersion, versionToRemove) >= 0\n  ) {\n    let message = `\\`${deprecatedAPI}\\` has been removed`;\n    if (versionToRemove) {\n      message = `${message} as of version \"${versionToRemove}\"`;\n    }\n    if (replacement && replacement.length) {\n      message = `${message} please migrate to: \\`${replacement}\\``;\n    }\n\n    throw new CodedError(`ERR_DEPRECATED_API`, prependLibrary(library, message));\n  }\n\n  let message = `\\`${deprecatedAPI}\\` has been deprecated`;\n  if (replacement && replacement.length) {\n    message = `${message} in favor of \\`${replacement}\\``;\n  }\n  if (versionToRemove && versionToRemove.length) {\n    message = `${message} and will be removed in version \"${versionToRemove}\"`;\n  }\n  console.warn(prependLibrary(library, message));\n}\n\nfunction prependLibrary(library: string, message: string): string {\n  return `${library}: ${message}`;\n}\n\n/**\n * Transform format:\n * Expo.AR -> EXPO_AR\n * expo-ar -> EXPO_AR\n */\nfunction codeFromLibrary(library: string): string {\n  const code = library.replace(/[-.]/g, '_').toUpperCase();\n  return code;\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}